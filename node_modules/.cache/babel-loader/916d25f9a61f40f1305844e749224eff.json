{"ast":null,"code":"var _jsxFileName = \"/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/luma/secondaries/src/components/PendingOrderModal/PendingOrderModal.tsx\",\n    _s = $RefreshSig$();\n\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport { Message } from '@luma-fe-workspace/design-system';\nimport { secondariesSlice, selectJwt, selectMessageObject, selectSecondaries, useAppDispatch, useAppSelector, useFillOrderUsingPutMutation, useRejectOrderUsingPutMutation } from '@luma-fe-workspace/redux';\nimport { useEffect, useState } from 'react';\nimport { RequiredModal } from '../RequiredModal/RequiredModal';\nimport { SecondariesTable } from '../SecondariesTable/SecondariesTable';\nimport { OrderSummary } from './PendingOrderModal.styles';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const PendingOrderModal = ({\n  setLiveOrder\n}) => {\n  _s();\n\n  var _pendingOrder$product, _useAppSelector, _pendingOrder$associa, _pendingOrder$associa2, _pendingOrder$side;\n\n  const dispatch = useAppDispatch();\n  const [visible, setVisible] = useState(true);\n  const secondariesStore = useAppSelector(selectSecondaries);\n  const messageObject = useAppSelector(selectMessageObject);\n  const pendingActionOrders = secondariesStore.pendingActionOrders;\n  const pendingOrder = pendingActionOrders[0];\n  const [fillOrderMutation] = useFillOrderUsingPutMutation();\n  const [rejectOrderMutation] = useRejectOrderUsingPutMutation();\n  const cusip = (_pendingOrder$product = pendingOrder.productIdentifier) == null ? void 0 : _pendingOrder$product.securityIdentifierValue;\n  const firstName = (_useAppSelector = useAppSelector(selectJwt)) == null ? void 0 : _useAppSelector.firstName;\n  useEffect(() => {\n    if (pendingActionOrders.length > 0) {\n      setVisible(true);\n    } else {\n      setVisible(false);\n    }\n  }, [pendingActionOrders]);\n\n  const handleOrder = async fill => {\n    if (!(pendingOrder != null && pendingOrder.orderId)) return;\n    const orderMutation = fill ? fillOrderMutation : rejectOrderMutation;\n\n    try {\n      const order = await orderMutation({\n        orderId: pendingOrder == null ? void 0 : pendingOrder.orderId\n      }).unwrap();\n\n      if (order) {\n        setLiveOrder(order);\n        handleMessage(fill, order, true);\n      }\n    } catch (error) {\n      handleMessage(fill, pendingOrder, false);\n    }\n  };\n\n  const handleMessage = (fill, order, success) => {\n    if (success) {\n      dispatch(secondariesSlice.actions.setMessageObject({\n        title: `${firstName != null ? firstName : 'You'} ${fill ? firstName ? 'agrees' : 'agree' : firstName ? 'rejects' : 'reject'} ${order.side === 'BUY' ? 'to buy' : 'to sell'} for ${order.quantity} ${cusip ? 'x ' + cusip : ''} at ${order.price}.`,\n        description: `${firstName ? firstName + \"'s\" : 'Your'} order number is ${order.orderId}`,\n        messageType: `${fill ? 'success' : 'error'}`,\n        isMessageShowing: true\n      }));\n    } else {\n      dispatch(secondariesSlice.actions.setMessageObject({\n        title: `Unable to ${fill ? 'fill' : 'reject'} order number ${order.orderId}.`,\n        messageType: 'error',\n        isMessageShowing: true\n      }));\n    }\n\n    dispatch(secondariesSlice.actions.removeFromPendingActionOrders(order));\n  };\n\n  const tableData = Object.assign({\n    'Settlement date': pendingOrder.settlement && new Date(pendingOrder.settlement).toLocaleDateString()\n  }, pendingOrder.side === 'BUY' ? {\n    Seller: (_pendingOrder$associa = pendingOrder.associatedUserIds) == null ? void 0 : _pendingOrder$associa.liquidityTaker\n  } : {\n    Buyer: (_pendingOrder$associa2 = pendingOrder.associatedUserIds) == null ? void 0 : _pendingOrder$associa2.liquidityTaker\n  });\n  return /*#__PURE__*/_jsxDEV(RequiredModal, {\n    id: 'pending-order',\n    title: 'Pending order',\n    secondaryTitle: `Order ID: ${pendingOrder.orderId}`,\n    shouldCloseOnEsc: true,\n    shouldCloseOnOverlayClick: true,\n    showModal: visible,\n    seperator: (_pendingOrder$side = pendingOrder.side) != null ? _pendingOrder$side : 'NONE',\n    rejectAction: {\n      text: 'REJECT',\n      onClick: async () => await handleOrder(false)\n    },\n    acceptAction: {\n      text: 'FILL',\n      onClick: async () => await handleOrder(true)\n    },\n    onClose: () => dispatch(secondariesSlice.actions.removeFromPendingActionOrders(pendingOrder)),\n    children: [/*#__PURE__*/_jsxDEV(OrderSummary, {\n      children: `${pendingOrder.side === 'BUY' ? 'Buy' : 'Sell'} ${pendingOrder.quantity} ${cusip ? 'x ' + cusip : ''} at ${pendingOrder.price}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SecondariesTable, {\n      rootStyles: 'width: 34.5rem',\n      data: tableData\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Message, {\n      title: messageObject.title,\n      description: messageObject.description,\n      showMessage: messageObject.isMessageShowing,\n      setShowMessage: showMessage => dispatch(secondariesSlice.actions.setIsMessageShowing(showMessage)),\n      messageType: messageObject.messageType // Seconds the message is visible before closing.\n      ,\n      timer: 5\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PendingOrderModal, \"BEsNlvRF7KUSNQzLc2QSroIeI+s=\", false, function () {\n  return [useAppDispatch, useAppSelector, useAppSelector, useFillOrderUsingPutMutation, useRejectOrderUsingPutMutation, useAppSelector];\n});\n\n_c = PendingOrderModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"PendingOrderModal\");","map":{"version":3,"names":["Message","secondariesSlice","selectJwt","selectMessageObject","selectSecondaries","useAppDispatch","useAppSelector","useFillOrderUsingPutMutation","useRejectOrderUsingPutMutation","useEffect","useState","RequiredModal","SecondariesTable","OrderSummary","PendingOrderModal","setLiveOrder","dispatch","visible","setVisible","secondariesStore","messageObject","pendingActionOrders","pendingOrder","fillOrderMutation","rejectOrderMutation","cusip","productIdentifier","securityIdentifierValue","firstName","length","handleOrder","fill","orderId","orderMutation","order","unwrap","handleMessage","error","success","actions","setMessageObject","title","side","quantity","price","description","messageType","isMessageShowing","removeFromPendingActionOrders","tableData","settlement","Date","toLocaleDateString","Seller","associatedUserIds","liquidityTaker","Buyer","text","onClick","showMessage","setIsMessageShowing"],"sources":["/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/luma/secondaries/src/components/PendingOrderModal/PendingOrderModal.tsx"],"sourcesContent":["import { Message } from '@luma-fe-workspace/design-system';\nimport {\n  secondariesSlice,\n  SecondaryOrder,\n  selectJwt,\n  selectMessageObject,\n  selectSecondaries,\n  useAppDispatch,\n  useAppSelector,\n  useFillOrderUsingPutMutation,\n  useRejectOrderUsingPutMutation,\n} from '@luma-fe-workspace/redux';\nimport { useEffect, useState } from 'react';\nimport { RequiredModal } from '../RequiredModal/RequiredModal';\nimport { SecondariesTable } from '../SecondariesTable/SecondariesTable';\nimport { OrderSummary } from './PendingOrderModal.styles';\n\ninterface PendingOrderModalProps {\n  setLiveOrder: (data: SecondaryOrder) => void;\n}\n\nexport const PendingOrderModal = ({ setLiveOrder }: PendingOrderModalProps) => {\n  const dispatch = useAppDispatch();\n  const [visible, setVisible] = useState<boolean>(true);\n  const secondariesStore = useAppSelector(selectSecondaries);\n  const messageObject = useAppSelector(selectMessageObject);\n  const pendingActionOrders = secondariesStore.pendingActionOrders;\n  const pendingOrder = pendingActionOrders[0];\n  const [fillOrderMutation] = useFillOrderUsingPutMutation();\n  const [rejectOrderMutation] = useRejectOrderUsingPutMutation();\n  const cusip = pendingOrder.productIdentifier?.securityIdentifierValue;\n  const firstName = useAppSelector(selectJwt)?.firstName;\n\n  useEffect(() => {\n    if (pendingActionOrders.length > 0) {\n      setVisible(true);\n    } else {\n      setVisible(false);\n    }\n  }, [pendingActionOrders]);\n\n  const handleOrder = async (fill: boolean) => {\n    if (!pendingOrder?.orderId) return;\n    const orderMutation = fill ? fillOrderMutation : rejectOrderMutation;\n    try {\n      const order = await orderMutation({\n        orderId: pendingOrder?.orderId,\n      }).unwrap();\n      if (order) {\n        setLiveOrder(order);\n        handleMessage(fill, order, true);\n      }\n    } catch (error) {\n      handleMessage(fill, pendingOrder, false);\n    }\n  };\n\n  const handleMessage = (\n    fill: boolean,\n    order: SecondaryOrder,\n    success: boolean\n  ) => {\n    if (success) {\n      dispatch(\n        secondariesSlice.actions.setMessageObject({\n          title: `${firstName ?? 'You'} ${\n            fill\n              ? firstName\n                ? 'agrees'\n                : 'agree'\n              : firstName\n              ? 'rejects'\n              : 'reject'\n          } ${order.side === 'BUY' ? 'to buy' : 'to sell'} for ${\n            order.quantity\n          } ${cusip ? 'x ' + cusip : ''} at ${order.price}.`,\n          description: `${\n            firstName ? firstName + \"'s\" : 'Your'\n          } order number is ${order.orderId}`,\n          messageType: `${fill ? 'success' : 'error'}`,\n          isMessageShowing: true,\n        })\n      );\n    } else {\n      dispatch(\n        secondariesSlice.actions.setMessageObject({\n          title: `Unable to ${fill ? 'fill' : 'reject'} order number ${\n            order.orderId\n          }.`,\n          messageType: 'error',\n          isMessageShowing: true,\n        })\n      );\n    }\n    dispatch(secondariesSlice.actions.removeFromPendingActionOrders(order));\n  };\n\n  const tableData = {\n    'Settlement date':\n      pendingOrder.settlement &&\n      new Date(pendingOrder.settlement).toLocaleDateString(),\n    ...(pendingOrder.side === 'BUY'\n      ? { Seller: pendingOrder.associatedUserIds?.liquidityTaker }\n      : { Buyer: pendingOrder.associatedUserIds?.liquidityTaker }),\n  };\n\n  return (\n    <RequiredModal\n      id={'pending-order'}\n      title={'Pending order'}\n      secondaryTitle={`Order ID: ${pendingOrder.orderId}`}\n      shouldCloseOnEsc={true}\n      shouldCloseOnOverlayClick={true}\n      showModal={visible}\n      seperator={pendingOrder.side ?? 'NONE'}\n      rejectAction={{\n        text: 'REJECT',\n        onClick: async () => await handleOrder(false),\n      }}\n      acceptAction={{\n        text: 'FILL',\n        onClick: async () => await handleOrder(true),\n      }}\n      onClose={() =>\n        dispatch(\n          secondariesSlice.actions.removeFromPendingActionOrders(pendingOrder)\n        )\n      }\n    >\n      <OrderSummary>{`${pendingOrder.side === 'BUY' ? 'Buy' : 'Sell'} ${\n        pendingOrder.quantity\n      } ${cusip ? 'x ' + cusip : ''} at ${pendingOrder.price}`}</OrderSummary>\n      <SecondariesTable rootStyles={'width: 34.5rem'} data={tableData} />\n      <Message\n        title={messageObject.title}\n        description={messageObject.description}\n        showMessage={messageObject.isMessageShowing}\n        setShowMessage={(showMessage: boolean) =>\n          dispatch(secondariesSlice.actions.setIsMessageShowing(showMessage))\n        }\n        messageType={messageObject.messageType}\n        // Seconds the message is visible before closing.\n        timer={5}\n      />\n    </RequiredModal>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}