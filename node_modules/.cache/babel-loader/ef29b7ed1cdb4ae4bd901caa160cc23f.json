{"ast":null,"code":"import _objectWithoutPropertiesLoose from \"/Users/jchen/Documents/GitHub/luma-fe-workspace/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js\";\nconst _excluded = [\"group\"];\nvar _jsxFileName = \"/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/luma/creationhub/src/components/PricingForm/groups/ConfigurableFormGroups/formElements/FormGroup.tsx\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.parse-int.js\";\nimport produce from 'immer';\nimport { FormField } from '.';\nimport { BasketShow } from './basket/BasketShow';\nimport { ValueTypes } from '@luma-fe-workspace/redux';\nimport { FieldWrapper, FormFieldError, FormGroupWrapper, GroupLabel, LineBreak } from './FormGroup.style';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport function FormGroup(_ref) {\n  var _fields$find, _fields$map;\n\n  let {\n    group: {\n      fields,\n      label\n    }\n  } = _ref,\n      params = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  const basketId = fields == null ? void 0 : (_fields$find = fields.find(({\n    paramName\n  }) => {\n    var _params$values$paramN;\n\n    const type = (_params$values$paramN = params.values[paramName]) == null ? void 0 : _params$values$paramN.type;\n    return [ValueTypes.UnweightedBasket, ValueTypes.WeightedBasket].includes(type);\n  })) == null ? void 0 : _fields$find.paramName;\n\n  const onValidation = (paramName, newValue) => {\n    const newValues = Object.assign({}, params.values);\n\n    if (newValue === undefined) {\n      delete newValues[paramName];\n    } else {\n      newValues[paramName] = newValue;\n    }\n\n    params.handleValidation(newValues);\n  };\n\n  const onBasketRemove = (paramName, id) => {\n    const newBasket = produce(params.values[paramName], draft => {\n      draft.underliers = draft.underliers.filter(({\n        underlier\n      }) => underlier.id !== id);\n    });\n    params.setFieldValue(paramName, newBasket);\n    onValidation(paramName, newBasket);\n  };\n\n  const onWeightChange = (paramName, id, value) => {\n    const newWeight = parseInt(value, 10) / 100 || undefined;\n    const newBasket = produce(params.values[paramName], draft => {\n      const underlierIndex = draft.underliers.findIndex(({\n        underlier\n      }) => underlier.id === id);\n      draft.underliers[underlierIndex].weight = newWeight;\n    });\n    params.setFieldValue(paramName, newBasket);\n  };\n\n  const row = (_fields$map = fields == null ? void 0 : fields.map(field => {\n    const fieldName = field.paramName;\n    const hasError = (fieldName in params.errors);\n    return /*#__PURE__*/_jsxDEV(FieldWrapper, {\n      children: [/*#__PURE__*/_jsxDEV(FormField, Object.assign({\n        name: fieldName,\n        field: field,\n        hasError: hasError,\n        onValidation: onValidation\n      }, params), void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this), hasError && /*#__PURE__*/_jsxDEV(FormFieldError, {\n        children: params.errors[fieldName]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }, this)]\n    }, fieldName, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }, this);\n  })) != null ? _fields$map : null;\n  return /*#__PURE__*/_jsxDEV(FormGroupWrapper, {\n    children: [label && /*#__PURE__*/_jsxDEV(GroupLabel, {\n      children: label\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 17\n    }, this), row, !!basketId && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(LineBreak, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(BasketShow, Object.assign({\n        paramName: basketId,\n        basket: params.values[basketId],\n        onBasketRemove: onBasketRemove,\n        onWeightChange: onWeightChange\n      }, params), void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n_c = FormGroup;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormGroup\");","map":{"version":3,"names":["produce","FormField","BasketShow","ValueTypes","FieldWrapper","FormFieldError","FormGroupWrapper","GroupLabel","LineBreak","FormGroup","group","fields","label","params","basketId","find","paramName","type","values","UnweightedBasket","WeightedBasket","includes","onValidation","newValue","newValues","undefined","handleValidation","onBasketRemove","id","newBasket","draft","underliers","filter","underlier","setFieldValue","onWeightChange","value","newWeight","parseInt","underlierIndex","findIndex","weight","row","map","field","fieldName","hasError","errors"],"sources":["/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/luma/creationhub/src/components/PricingForm/groups/ConfigurableFormGroups/formElements/FormGroup.tsx"],"sourcesContent":["import produce from 'immer';\nimport { PricingFormProps } from '../../../PricingForm';\nimport { FormField } from '.';\nimport { BasketShow } from './basket/BasketShow';\nimport {\n  Basket,\n  ParamConstraints,\n  FieldGroup,\n  ParamName,\n  SectionField,\n  ValueTypes,\n  WeightedBasket,\n  ParamValue,\n} from '@luma-fe-workspace/redux';\nimport {\n  FieldWrapper,\n  FormFieldError,\n  FormGroupWrapper,\n  GroupLabel,\n  LineBreak,\n} from './FormGroup.style';\n\ninterface FormGroupProps extends PricingFormProps {\n  group: FieldGroup;\n  constraints: Record<ParamName, ParamConstraints>;\n}\n\nexport function FormGroup({\n  group: { fields, label },\n  ...params\n}: FormGroupProps) {\n  const basketId = fields?.find(({ paramName }: SectionField) => {\n    const type = params.values[paramName]?.type;\n    return [ValueTypes.UnweightedBasket, ValueTypes.WeightedBasket].includes(\n      type as ValueTypes\n    );\n  })?.paramName;\n\n  const onValidation = (\n    paramName: ParamName,\n    newValue: ParamValue | undefined\n  ) => {\n    const newValues = { ...params.values };\n    if (newValue === undefined) {\n      delete newValues[paramName];\n    } else {\n      newValues[paramName] = newValue;\n    }\n    params.handleValidation(newValues);\n  };\n\n  const onBasketRemove = (paramName: ParamName, id: string) => {\n    const newBasket = produce(\n      params.values[paramName] as Basket,\n      (draft: Basket) => {\n        draft.underliers = draft.underliers.filter(\n          ({ underlier }) => underlier.id !== id\n        );\n      }\n    );\n    params.setFieldValue(paramName, newBasket);\n    onValidation(paramName, newBasket);\n  };\n\n  const onWeightChange = (paramName: ParamName, id: string, value: string) => {\n    const newWeight = parseInt(value, 10) / 100 || undefined;\n    const newBasket = produce(\n      params.values[paramName] as WeightedBasket,\n      (draft: WeightedBasket) => {\n        const underlierIndex = draft.underliers.findIndex(\n          ({ underlier }) => underlier.id === id\n        );\n        draft.underliers[underlierIndex].weight = newWeight;\n      }\n    );\n    params.setFieldValue(paramName, newBasket);\n  };\n\n  const row =\n    fields?.map((field: SectionField) => {\n      const fieldName = field.paramName;\n      const hasError = fieldName in params.errors;\n      return (\n        <FieldWrapper key={fieldName}>\n          <FormField\n            name={fieldName}\n            field={field}\n            hasError={hasError}\n            onValidation={onValidation}\n            {...params}\n          />\n          {hasError && (\n            <FormFieldError>{params.errors[fieldName]}</FormFieldError>\n          )}\n        </FieldWrapper>\n      );\n    }) ?? null;\n  return (\n    <FormGroupWrapper>\n      {label && <GroupLabel>{label}</GroupLabel>}\n      {row}\n      {!!basketId && (\n        <>\n          <LineBreak />\n          <BasketShow\n            paramName={basketId}\n            basket={params.values[basketId] as Basket}\n            onBasketRemove={onBasketRemove}\n            onWeightChange={onWeightChange}\n            {...params}\n          />\n        </>\n      )}\n    </FormGroupWrapper>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}