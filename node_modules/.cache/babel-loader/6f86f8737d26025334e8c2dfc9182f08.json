{"ast":null,"code":"var _jsxFileName = \"/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/luma/secondaries/src/components/TableCellQuoteSelector/TableCellQuoteSelector.tsx\",\n    _s = $RefreshSig$();\n\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.promise.js\";\nimport { Icon } from '@luma-fe-workspace/design-system';\nimport { useSelect } from 'downshift';\nimport { secondariesSlice, selectJwt, useAppDispatch, useAppSelector, useCreateOrderUsingPostMutation } from '@luma-fe-workspace/redux';\nimport { BestQuoteDivider, QuoteAcceptButton, QuoteAmount, QuoteDeadline, QuoteList, QuoteListItem, QuoteSelectorButton, QuoteSelectorOfferCount, QuoteSelectorOffers, Root } from './TableCellQuoteSelector.styles';\nimport { DateHelper } from '@luma-fe-workspace/utility';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const TableCellQuoteSelector = ({\n  quotes,\n  status,\n  id,\n  disabled,\n  RFQRequestId\n}) => {\n  _s();\n\n  var _useAppSelector, _quotes$2;\n\n  const firstName = (_useAppSelector = useAppSelector(selectJwt)) == null ? void 0 : _useAppSelector.firstName;\n  const [createOrder] = useCreateOrderUsingPostMutation();\n  const dispatch = useAppDispatch();\n  const isCollecting = status === 'OPEN';\n  const noQuoteResponses = quotes.length === 0;\n  const {\n    isOpen,\n    getToggleButtonProps,\n    getMenuProps,\n    getItemProps\n  } = useSelect({\n    id,\n    items: quotes\n  });\n  const buttonProps = Object.assign({}, getToggleButtonProps({\n    disabled: disabled || noQuoteResponses || !isCollecting\n  }));\n\n  const acceptQuote = async () => {\n    var _quotes$;\n\n    if (RFQRequestId && (_quotes$ = quotes[0]) != null && _quotes$.responseId) {\n      try {\n        const order = await createOrder({\n          secondaryOrder: {\n            associatedRequestId: RFQRequestId,\n            associatedResponseId: quotes[0].responseId\n          }\n        }).unwrap();\n\n        if (order) {\n          var _order$productIdentif, _order$productIdentif2;\n\n          dispatch(secondariesSlice.actions.addOrUpdateOrders(order));\n          dispatch(secondariesSlice.actions.setMessageObject({\n            title: `${firstName != null ? firstName : 'You'} accepted ${order.side === 'BUY' ? 'a bid' : 'an offer'} for ${order.quantity} ${(_order$productIdentif = order.productIdentifier) != null && _order$productIdentif.securityIdentifierValue ? 'x ' + ((_order$productIdentif2 = order.productIdentifier) == null ? void 0 : _order$productIdentif2.securityIdentifierValue) : ''} at ${order.price}.`,\n            description: `${firstName ? firstName + \"'s\" : 'Your'} order number is ${order.orderId}`,\n            messageType: 'success',\n            isMessageShowing: true\n          }));\n        }\n      } catch (error) {\n        dispatch(secondariesSlice.actions.setMessageObject({\n          title: 'Unable to accept bid for Request for Quote.',\n          messageType: 'error',\n          isMessageShowing: true\n        }));\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Root, {\n    children: [/*#__PURE__*/_jsxDEV(QuoteSelectorButton, Object.assign({}, buttonProps, {\n      static: noQuoteResponses || !isCollecting,\n      className: disabled && 'disabled',\n      \"aria-label\": \"Quote Selector\",\n      children: [(_quotes$2 = quotes[0]) == null ? void 0 : _quotes$2.quoteAmount, !noQuoteResponses && isCollecting ? /*#__PURE__*/_jsxDEV(QuoteSelectorOffers, {\n        className: disabled ? 'disabled' : '',\n        children: [/*#__PURE__*/_jsxDEV(Icon, {\n          iconCode: \"chevron-down\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(QuoteSelectorOfferCount, {\n          children: quotes.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this) : null]\n    }), void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), !noQuoteResponses && isCollecting ? /*#__PURE__*/_jsxDEV(QuoteList, Object.assign({}, getMenuProps(), {\n      isOpen: isOpen,\n      \"aria-labelledby\": buttonProps.id,\n      children: [/*#__PURE__*/_jsxDEV(QuoteAcceptButton, {\n        onClick: acceptQuote,\n        children: \"ACCEPT\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }, this), isOpen && quotes.map((quote, idx) => {\n        const isFirstElem = 0 === idx;\n        const itemProps = getItemProps({\n          item: quote,\n          index: idx,\n          onClick: isFirstElem ? acceptQuote : undefined,\n          readOnly: !isFirstElem,\n          disabled: !isFirstElem\n        });\n        const goodUntilTime = DateHelper.convertToUTC(quote.goodUntilTime);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(QuoteListItem, Object.assign({}, itemProps, {\n            children: [/*#__PURE__*/_jsxDEV(QuoteAmount, {\n              multipleQuotes: quotes.length > 1,\n              children: [quote.quoteAmount, ' ', idx !== 1 ? null : quote.firm && `(${quote.firm})`]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 135,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(QuoteDeadline, {\n              children: goodUntilTime.toLocaleTimeString([], {\n                hour: '2-digit',\n                minute: '2-digit'\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 21\n            }, this)]\n          }), void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 19\n          }, this), isFirstElem && quotes.length > 1 && /*#__PURE__*/_jsxDEV(BestQuoteDivider, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 56\n          }, this)]\n        }, `${quote.quoteAmount}-${idx}`, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 17\n        }, this);\n      })]\n    }), void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n};\n\n_s(TableCellQuoteSelector, \"fjzCDyRca7fT5p8u6OoQkb1KijI=\", false, function () {\n  return [useAppSelector, useCreateOrderUsingPostMutation, useAppDispatch, useSelect];\n});\n\n_c = TableCellQuoteSelector;\n\nvar _c;\n\n$RefreshReg$(_c, \"TableCellQuoteSelector\");","map":{"version":3,"names":["Icon","useSelect","secondariesSlice","selectJwt","useAppDispatch","useAppSelector","useCreateOrderUsingPostMutation","BestQuoteDivider","QuoteAcceptButton","QuoteAmount","QuoteDeadline","QuoteList","QuoteListItem","QuoteSelectorButton","QuoteSelectorOfferCount","QuoteSelectorOffers","Root","DateHelper","TableCellQuoteSelector","quotes","status","id","disabled","RFQRequestId","firstName","createOrder","dispatch","isCollecting","noQuoteResponses","length","isOpen","getToggleButtonProps","getMenuProps","getItemProps","items","buttonProps","acceptQuote","responseId","order","secondaryOrder","associatedRequestId","associatedResponseId","unwrap","actions","addOrUpdateOrders","setMessageObject","title","side","quantity","productIdentifier","securityIdentifierValue","price","description","orderId","messageType","isMessageShowing","error","quoteAmount","map","quote","idx","isFirstElem","itemProps","item","index","onClick","undefined","readOnly","goodUntilTime","convertToUTC","firm","toLocaleTimeString","hour","minute"],"sources":["/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/luma/secondaries/src/components/TableCellQuoteSelector/TableCellQuoteSelector.tsx"],"sourcesContent":["import { Icon } from '@luma-fe-workspace/design-system';\nimport { useSelect } from 'downshift';\nimport {\n  secondariesSlice,\n  SecondaryQuote,\n  selectJwt,\n  useAppDispatch,\n  useAppSelector,\n  useCreateOrderUsingPostMutation,\n} from '@luma-fe-workspace/redux';\nimport {\n  BestQuoteDivider,\n  QuoteAcceptButton,\n  QuoteAmount,\n  QuoteDeadline,\n  QuoteList,\n  QuoteListItem,\n  QuoteSelectorButton,\n  QuoteSelectorOfferCount,\n  QuoteSelectorOffers,\n  Root,\n} from './TableCellQuoteSelector.styles';\nimport { DateHelper } from '@luma-fe-workspace/utility';\n\nexport interface TableCellQuoteSelectorProps {\n  id: string;\n  quotes: SecondaryQuote[];\n  status: string;\n  disabled: boolean;\n  RFQRequestId: number | undefined;\n}\n\nexport const TableCellQuoteSelector = ({\n  quotes,\n  status,\n  id,\n  disabled,\n  RFQRequestId,\n}: TableCellQuoteSelectorProps) => {\n  const firstName = useAppSelector(selectJwt)?.firstName;\n  const [createOrder] = useCreateOrderUsingPostMutation();\n  const dispatch = useAppDispatch();\n  const isCollecting = status === 'OPEN';\n  const noQuoteResponses = quotes.length === 0;\n  const { isOpen, getToggleButtonProps, getMenuProps, getItemProps } =\n    useSelect({\n      id,\n      items: quotes,\n    });\n  const buttonProps = {\n    ...getToggleButtonProps({\n      disabled: disabled || noQuoteResponses || !isCollecting,\n    }),\n  };\n\n  const acceptQuote = async () => {\n    if (RFQRequestId && quotes[0]?.responseId) {\n      try {\n        const order = await createOrder({\n          secondaryOrder: {\n            associatedRequestId: RFQRequestId,\n            associatedResponseId: quotes[0].responseId,\n          },\n        }).unwrap();\n        if (order) {\n          dispatch(secondariesSlice.actions.addOrUpdateOrders(order));\n          dispatch(\n            secondariesSlice.actions.setMessageObject({\n              title: `${firstName ?? 'You'} accepted ${\n                order.side === 'BUY' ? 'a bid' : 'an offer'\n              } for ${order.quantity} ${\n                order.productIdentifier?.securityIdentifierValue\n                  ? 'x ' + order.productIdentifier?.securityIdentifierValue\n                  : ''\n              } at ${order.price}.`,\n              description: `${\n                firstName ? firstName + \"'s\" : 'Your'\n              } order number is ${order.orderId}`,\n              messageType: 'success',\n              isMessageShowing: true,\n            })\n          );\n        }\n      } catch (error) {\n        dispatch(\n          secondariesSlice.actions.setMessageObject({\n            title: 'Unable to accept bid for Request for Quote.',\n            messageType: 'error',\n            isMessageShowing: true,\n          })\n        );\n      }\n    }\n  };\n\n  return (\n    <Root>\n      <QuoteSelectorButton\n        {...buttonProps}\n        static={noQuoteResponses || !isCollecting}\n        className={disabled && 'disabled'}\n        aria-label=\"Quote Selector\"\n      >\n        {quotes[0]?.quoteAmount}\n        {!noQuoteResponses && isCollecting ? (\n          <QuoteSelectorOffers className={disabled ? 'disabled' : ''}>\n            <Icon iconCode=\"chevron-down\" />\n            <QuoteSelectorOfferCount>{quotes.length}</QuoteSelectorOfferCount>\n          </QuoteSelectorOffers>\n        ) : null}\n      </QuoteSelectorButton>\n      {!noQuoteResponses && isCollecting ? (\n        <QuoteList\n          {...getMenuProps()}\n          isOpen={isOpen}\n          aria-labelledby={buttonProps.id}\n        >\n          <QuoteAcceptButton onClick={acceptQuote}>ACCEPT</QuoteAcceptButton>\n          {isOpen &&\n            quotes.map((quote, idx) => {\n              const isFirstElem = 0 === idx;\n              const itemProps = getItemProps({\n                item: quote,\n                index: idx,\n                onClick: isFirstElem ? acceptQuote : undefined,\n                readOnly: !isFirstElem,\n                disabled: !isFirstElem,\n              });\n              const goodUntilTime = DateHelper.convertToUTC(\n                quote.goodUntilTime\n              );\n              return (\n                <div key={`${quote.quoteAmount}-${idx}`}>\n                  <QuoteListItem {...itemProps}>\n                    <QuoteAmount multipleQuotes={quotes.length > 1}>\n                      {quote.quoteAmount}{' '}\n                      {idx !== 1 ? null : quote.firm && `(${quote.firm})`}\n                    </QuoteAmount>\n                    <QuoteDeadline>\n                      {goodUntilTime.toLocaleTimeString([], {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                      })}\n                    </QuoteDeadline>\n                  </QuoteListItem>\n                  {isFirstElem && quotes.length > 1 && <BestQuoteDivider />}\n                </div>\n              );\n            })}\n        </QuoteList>\n      ) : null}\n    </Root>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}