{"ast":null,"code":"var _jsxFileName = \"/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/redux/src/components/AuthGuard/AuthGuard.tsx\",\n    _s = $RefreshSig$();\n\nimport { Navigate } from 'react-router-dom';\nimport { useSyncLogout } from '../../hooks/UseSyncLogout';\nimport { useAppSelector } from '../../utils/hooks';\nimport { useValidateTokenQuery } from '../../redux/authService/slice';\nimport { selectAccessToken } from '../../redux/auth/selector';\nimport { getTokenFromProxy } from '../../utils/getTokenFromProxy';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthGuard = ({\n  children\n}) => {\n  _s();\n\n  const accessToken = useAppSelector(selectAccessToken);\n  const token = getTokenFromProxy();\n  useSyncLogout();\n  const {\n    isLoading,\n    isSuccess\n  } = useValidateTokenQuery({\n    bearer: token != null ? token : ''\n  }, {\n    skip: !token\n  });\n\n  if (accessToken || isSuccess) {\n    return children;\n  }\n\n  if (!token) return /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 22\n  }, this);\n\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"isLoading....\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 12\n    }, this);\n  }\n\n  if (!isSuccess) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 12\n    }, this);\n  }\n\n  return null;\n};\n\n_s(AuthGuard, \"O26/8mJ6AD7AhaX48BdoBmFcHgw=\", false, function () {\n  return [useAppSelector, useSyncLogout, useValidateTokenQuery];\n});\n\n_c = AuthGuard;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthGuard\");","map":{"version":3,"names":["Navigate","useSyncLogout","useAppSelector","useValidateTokenQuery","selectAccessToken","getTokenFromProxy","AuthGuard","children","accessToken","token","isLoading","isSuccess","bearer","skip"],"sources":["/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/redux/src/components/AuthGuard/AuthGuard.tsx"],"sourcesContent":["import { Navigate } from 'react-router-dom';\nimport { useSyncLogout } from '../../hooks/UseSyncLogout';\nimport { useAppSelector } from '../../utils/hooks';\nimport { useValidateTokenQuery } from '../../redux/authService/slice';\n\nimport { selectAccessToken } from '../../redux/auth/selector';\nimport { getTokenFromProxy } from '../../utils/getTokenFromProxy';\n\ninterface Props {\n  children: JSX.Element;\n}\n\nexport const AuthGuard = ({ children }: Props) => {\n  const accessToken = useAppSelector(selectAccessToken);\n  const token = getTokenFromProxy();\n  useSyncLogout();\n\n  const { isLoading, isSuccess } = useValidateTokenQuery(\n    {\n      bearer: token ?? '',\n    },\n    { skip: !token }\n  );\n\n  if (accessToken || isSuccess) {\n    return children;\n  }\n\n  if (!token) return <Navigate to=\"/\" />;\n\n  if (isLoading) {\n    return <div>isLoading....</div>;\n  }\n\n  if (!isSuccess) {\n    return <Navigate to=\"/\" />;\n  }\n\n  return null;\n};\n"],"mappings":";;;AAAA,SAASA,QAAT,QAAyB,kBAAzB;AACA,SAASC,aAAT,QAA8B,2BAA9B;AACA,SAASC,cAAT,QAA+B,mBAA/B;AACA,SAASC,qBAAT,QAAsC,+BAAtC;AAEA,SAASC,iBAAT,QAAkC,2BAAlC;AACA,SAASC,iBAAT,QAAkC,+BAAlC;;AAMA,OAAO,MAAMC,SAAS,GAAG,CAAC;EAAEC;AAAF,CAAD,KAAyB;EAAA;;EAChD,MAAMC,WAAW,GAAGN,cAAc,CAACE,iBAAD,CAAlC;EACA,MAAMK,KAAK,GAAGJ,iBAAiB,EAA/B;EACAJ,aAAa;EAEb,MAAM;IAAES,SAAF;IAAaC;EAAb,IAA2BR,qBAAqB,CACpD;IACES,MAAM,EAAEH,KAAF,WAAEA,KAAF,GAAW;EADnB,CADoD,EAIpD;IAAEI,IAAI,EAAE,CAACJ;EAAT,CAJoD,CAAtD;;EAOA,IAAID,WAAW,IAAIG,SAAnB,EAA8B;IAC5B,OAAOJ,QAAP;EACD;;EAED,IAAI,CAACE,KAAL,EAAY,oBAAO,QAAC,QAAD;IAAU,EAAE,EAAC;EAAb;IAAA;IAAA;IAAA;EAAA,QAAP;;EAEZ,IAAIC,SAAJ,EAAe;IACb,oBAAO;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAAP;EACD;;EAED,IAAI,CAACC,SAAL,EAAgB;IACd,oBAAO,QAAC,QAAD;MAAU,EAAE,EAAC;IAAb;MAAA;MAAA;MAAA;IAAA,QAAP;EACD;;EAED,OAAO,IAAP;AACD,CA3BM;;GAAML,S;UACSJ,c,EAEpBD,a,EAEiCE,qB;;;KALtBG,S"},"metadata":{},"sourceType":"module"}