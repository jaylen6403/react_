{"ast":null,"code":"var _jsxFileName = \"/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/luma/secondaries/src/components/SecondariesSearch/SecondariesSearch.tsx\",\n    _s = $RefreshSig$();\n\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\nimport { useCallback, useState } from 'react';\nimport { Search } from '@luma-fe-workspace/design-system';\nimport { useGetProductsUsingGetQuery, useAppDispatch, secondariesSlice } from '@luma-fe-workspace/redux';\nimport { SecondariesSearchResults } from './SecondariesSearchResults';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const SecondariesSearch = () => {\n  _s();\n\n  const [value, setValue] = useState('');\n  const {\n    data\n  } = useGetProductsUsingGetQuery({\n    paged: true,\n    pageSize: 50\n  });\n  const [items, setItems] = useState(data);\n  const dispatch = useAppDispatch();\n  const handleSubmit = useCallback(inputVal => {\n    dispatch(secondariesSlice.actions.setSecurityDetailsCusip(inputVal));\n  }, [dispatch]);\n\n  const handleSelectItem = selectedItem => {\n    if (selectedItem != null && selectedItem.productGeneral.cusip) {\n      setValue(selectedItem.productGeneral.cusip);\n      handleSubmit(selectedItem.productGeneral.cusip);\n    } else {\n      setValue('');\n    }\n  };\n\n  const handleChange = useCallback((newValue = '') => {\n    setValue(newValue);\n\n    if (data) {\n      const relevantItems = data.filter(item => {\n        if (item.productGeneral.cusip) {\n          var _item$productGeneral$;\n\n          return item.productGeneral.cusip.toLowerCase().startsWith(newValue.toLowerCase()) || ((_item$productGeneral$ = item.productGeneral.issuer) == null ? void 0 : _item$productGeneral$.toLowerCase().startsWith(newValue.toLowerCase()));\n        } else {\n          return false;\n        }\n      });\n      setItems(relevantItems);\n    }\n  }, [setValue, data]);\n  return /*#__PURE__*/_jsxDEV(Search, {\n    items: items != null ? items : [],\n    width: \"clamp(18.8125rem, 33.33vw, 25.0625rem)\",\n    marginRight: \"1rem\",\n    initialValue: value,\n    handleSelectItem: handleSelectItem,\n    handleChange: handleChange,\n    placeholder: \"Search CUSIP/ISIN\",\n    itemToString: item => {\n      if (item != null && item.productGeneral.cusip) {\n        return item.productGeneral.cusip;\n      } else {\n        return '';\n      }\n    },\n    renderContent: /*#__PURE__*/_jsxDEV(SecondariesSearchResults, {\n      item: undefined\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 22\n    }, this),\n    inputAriaLabel: 'input cusip',\n    buttonAriaLabel: 'clear input'\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n};\n\n_s(SecondariesSearch, \"bqncHxD3sWUSgi6J2cMbkOTC6Tc=\", false, function () {\n  return [useGetProductsUsingGetQuery, useAppDispatch];\n});\n\n_c = SecondariesSearch;\n\nvar _c;\n\n$RefreshReg$(_c, \"SecondariesSearch\");","map":{"version":3,"names":["useCallback","useState","Search","useGetProductsUsingGetQuery","useAppDispatch","secondariesSlice","SecondariesSearchResults","SecondariesSearch","value","setValue","data","paged","pageSize","items","setItems","dispatch","handleSubmit","inputVal","actions","setSecurityDetailsCusip","handleSelectItem","selectedItem","productGeneral","cusip","handleChange","newValue","relevantItems","filter","item","toLowerCase","startsWith","issuer","undefined"],"sources":["/Users/jchen/Documents/GitHub/luma-fe-workspace/libs/luma/secondaries/src/components/SecondariesSearch/SecondariesSearch.tsx"],"sourcesContent":["import { useCallback, useState } from 'react';\n\nimport { Search } from '@luma-fe-workspace/design-system';\n\nimport {\n  useGetProductsUsingGetQuery,\n  Product,\n  useAppDispatch,\n  secondariesSlice,\n} from '@luma-fe-workspace/redux';\n\nimport { SecondariesSearchResults } from './SecondariesSearchResults';\n\ntype handleItemType = Product | undefined | null;\n\nexport const SecondariesSearch = () => {\n  const [value, setValue] = useState('');\n  const { data } = useGetProductsUsingGetQuery({\n    paged: true,\n    pageSize: 50,\n  });\n  const [items, setItems] = useState(data);\n  const dispatch = useAppDispatch();\n\n  const handleSubmit = useCallback(\n    (inputVal: string) => {\n      dispatch(secondariesSlice.actions.setSecurityDetailsCusip(inputVal));\n    },\n    [dispatch]\n  );\n\n  const handleSelectItem = (selectedItem: handleItemType) => {\n    if (selectedItem?.productGeneral.cusip) {\n      setValue(selectedItem.productGeneral.cusip);\n      handleSubmit(selectedItem.productGeneral.cusip);\n    } else {\n      setValue('');\n    }\n  };\n\n  const handleChange = useCallback(\n    (newValue = '') => {\n      setValue(newValue);\n      if (data) {\n        const relevantItems = data.filter((item: Product) => {\n          if (item.productGeneral.cusip) {\n            return (\n              item.productGeneral.cusip\n                .toLowerCase()\n                .startsWith(newValue.toLowerCase()) ||\n              item.productGeneral.issuer\n                ?.toLowerCase()\n                .startsWith(newValue.toLowerCase())\n            );\n          } else {\n            return false;\n          }\n        });\n        setItems(relevantItems);\n      }\n    },\n    [setValue, data]\n  );\n\n  return (\n    <Search\n      items={items ?? []}\n      width=\"clamp(18.8125rem, 33.33vw, 25.0625rem)\"\n      marginRight=\"1rem\"\n      initialValue={value}\n      handleSelectItem={handleSelectItem}\n      handleChange={handleChange}\n      placeholder=\"Search CUSIP/ISIN\"\n      itemToString={(item) => {\n        if (item?.productGeneral.cusip) {\n          return item.productGeneral.cusip;\n        } else {\n          return '';\n        }\n      }}\n      renderContent={<SecondariesSearchResults item={undefined} />}\n      inputAriaLabel={'input cusip'}\n      buttonAriaLabel={'clear input'}\n    />\n  );\n};\n"],"mappings":";;;;;;AAAA,SAASA,WAAT,EAAsBC,QAAtB,QAAsC,OAAtC;AAEA,SAASC,MAAT,QAAuB,kCAAvB;AAEA,SACEC,2BADF,EAGEC,cAHF,EAIEC,gBAJF,QAKO,0BALP;AAOA,SAASC,wBAAT,QAAyC,4BAAzC;;AAIA,OAAO,MAAMC,iBAAiB,GAAG,MAAM;EAAA;;EACrC,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBR,QAAQ,CAAC,EAAD,CAAlC;EACA,MAAM;IAAES;EAAF,IAAWP,2BAA2B,CAAC;IAC3CQ,KAAK,EAAE,IADoC;IAE3CC,QAAQ,EAAE;EAFiC,CAAD,CAA5C;EAIA,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBb,QAAQ,CAACS,IAAD,CAAlC;EACA,MAAMK,QAAQ,GAAGX,cAAc,EAA/B;EAEA,MAAMY,YAAY,GAAGhB,WAAW,CAC7BiB,QAAD,IAAsB;IACpBF,QAAQ,CAACV,gBAAgB,CAACa,OAAjB,CAAyBC,uBAAzB,CAAiDF,QAAjD,CAAD,CAAR;EACD,CAH6B,EAI9B,CAACF,QAAD,CAJ8B,CAAhC;;EAOA,MAAMK,gBAAgB,GAAIC,YAAD,IAAkC;IACzD,IAAIA,YAAJ,YAAIA,YAAY,CAAEC,cAAd,CAA6BC,KAAjC,EAAwC;MACtCd,QAAQ,CAACY,YAAY,CAACC,cAAb,CAA4BC,KAA7B,CAAR;MACAP,YAAY,CAACK,YAAY,CAACC,cAAb,CAA4BC,KAA7B,CAAZ;IACD,CAHD,MAGO;MACLd,QAAQ,CAAC,EAAD,CAAR;IACD;EACF,CAPD;;EASA,MAAMe,YAAY,GAAGxB,WAAW,CAC9B,CAACyB,QAAQ,GAAG,EAAZ,KAAmB;IACjBhB,QAAQ,CAACgB,QAAD,CAAR;;IACA,IAAIf,IAAJ,EAAU;MACR,MAAMgB,aAAa,GAAGhB,IAAI,CAACiB,MAAL,CAAaC,IAAD,IAAmB;QACnD,IAAIA,IAAI,CAACN,cAAL,CAAoBC,KAAxB,EAA+B;UAAA;;UAC7B,OACEK,IAAI,CAACN,cAAL,CAAoBC,KAApB,CACGM,WADH,GAEGC,UAFH,CAEcL,QAAQ,CAACI,WAAT,EAFd,+BAGAD,IAAI,CAACN,cAAL,CAAoBS,MAHpB,qBAGA,sBACIF,WADJ,GAEGC,UAFH,CAEcL,QAAQ,CAACI,WAAT,EAFd,CAHA,CADF;QAQD,CATD,MASO;UACL,OAAO,KAAP;QACD;MACF,CAbqB,CAAtB;MAcAf,QAAQ,CAACY,aAAD,CAAR;IACD;EACF,CApB6B,EAqB9B,CAACjB,QAAD,EAAWC,IAAX,CArB8B,CAAhC;EAwBA,oBACE,QAAC,MAAD;IACE,KAAK,EAAEG,KAAF,WAAEA,KAAF,GAAW,EADlB;IAEE,KAAK,EAAC,wCAFR;IAGE,WAAW,EAAC,MAHd;IAIE,YAAY,EAAEL,KAJhB;IAKE,gBAAgB,EAAEY,gBALpB;IAME,YAAY,EAAEI,YANhB;IAOE,WAAW,EAAC,mBAPd;IAQE,YAAY,EAAGI,IAAD,IAAU;MACtB,IAAIA,IAAJ,YAAIA,IAAI,CAAEN,cAAN,CAAqBC,KAAzB,EAAgC;QAC9B,OAAOK,IAAI,CAACN,cAAL,CAAoBC,KAA3B;MACD,CAFD,MAEO;QACL,OAAO,EAAP;MACD;IACF,CAdH;IAeE,aAAa,eAAE,QAAC,wBAAD;MAA0B,IAAI,EAAES;IAAhC;MAAA;MAAA;MAAA;IAAA,QAfjB;IAgBE,cAAc,EAAE,aAhBlB;IAiBE,eAAe,EAAE;EAjBnB;IAAA;IAAA;IAAA;EAAA,QADF;AAqBD,CAtEM;;GAAMzB,iB;UAEMJ,2B,EAKAC,c;;;KAPNG,iB"},"metadata":{},"sourceType":"module"}